# Noir React Native

**NoirReactNative** is a React Native package for generating and verifying [Noir](https://noir-lang.org/) zero-knowledge proofs using the Barretenberg backend.

The Swift bindings are generated by the [**mopro CLI**](https://zkmopro.org/docs/getting-started) using the **Noir adapter**, which relies on a prebuilt Barretenberg backend.

To learn more about the original Rust implementation before generating bindings, please refer to [noir-rs](https://github.com/zkmopro/noir-rs).

## How to Import the Package

Use a Node.js package manager in your React Native app to install dependencies. For example:

```sh
# npm
npm install https://github.com/zkmopro/NoirReactNative # Or change to your own URL
# yarn / pnpm
yarn add https://github.com/zkmopro/NoirReactNative # Or change to your own URL
```

Or add this in `package.json`

```json
"dependencies": {
    "mopro-ffi": "github:zkmopro/NoirReactNative"
}
```

## How to Use the Package

Here is an example of how to integrate and use this package.<br/>
For the full test implementation, see [example/App.tsx](example/App.tsx).

### Import the package

```typescript
import {
  getNoirVerificationKey,
  generateNoirProof,
  verifyNoirProof,
} from 'mopro-ffi';
```

### Load circuit and srs

Please checkout [noir-rs](https://github.com/zkmopro/noir-rs) to see how to generate the circuit and the srs.

To load the circuit and srs in a React Native app, please checkout [`loadAssets`](https://github.com/zkmopro/react-native-app/blob/7bd97d6256644727253716fddcc4f07c17a61293/src/App.tsx#L30) to get the path. Then define the file path, e.g.

```typescript
const circuitPath = await loadAssets(circuitName);
const srsPath = await loadAssets(srsName);
```

### `getNoirVerificationKey`

```typescript
const onChain = true; // Use Keccak for Solidity compatibility
const lowMemoryMode = false;
const inputs = ['3', '5'];

const verificationKey = getNoirVerificationKey(
  circuitPath.replace('file://', ''),
  srsPath.replace('file://', ''),
  onChain,
  lowMemoryMode
);
```

### `generateNoirProof`

```typescript
const proof: ArrayBuffer = generateNoirProof(
    circuitPath.replace('file://', ''),
    srsPath.replace('file://', ''),
    circuitInputs,
    onChain,
    verificationKey,
    lowMemoryMode
);
```

### `verifyNoirProof`

```typescript
const res: boolean = verifyNoirProof(
    circuitPath.replace('file://', ''),
    proof,
    onChain,
    vk,
    lowMemoryMode
);
```

## How to Build the Package

1. Use `mopro-cli` and choose `noir`

```sh
mopro init
```

choose `noir`

```sh
mopro build
```

choose `react-native` and all architectures.

2. Then, replace the entire bindings directory `MoproReactNativeBindings` with your generated files in the current folder:

```sh
├── android
├── babel.config.js
├── cpp
├── example # Optional: keep this folder
├── ios
├── lib
├── MoproFfiFramework.xcframework
├── node_modules
├── package-lock.json
├── package.json
├── README.md
├── src
├── tsconfig.build.json
├── tsconfig.json
├── turbo.json
└── ubrn.config.yaml
```

or running, e.g.

```sh
cp -R \
  MoproReactNativeBindings/android \
  MoproReactNativeBindings/ios \
  MoproReactNativeBindings/src \
  MoproReactNativeBindings/lib \
  MoproReactNativeBindings/MoproFfiFramework.xcframework \
  MoproReactNativeBindings/package.json \
  mopro-react-native-package/
```

3. Zip the `MoproFfiFramework.xcframework`

4. Upload the `MoproFfiFramework.xcframework` to some URL

5. Update the [check-mopro-download.sh](check-mopro-download.sh) script

## Test the package

Use the example app folder:

1. Install the dependencies

```sh
npm install
```

2. Start the server

```sh
npm run start
```

3. Run the app on iOS

```sh
npm run ios
```

4. Run the app on Android

```sh
export ANDROID_HOME=~/Library/Android/sdk/
```

```sh
npm run android
```

> [!WARNING]
> If you are using Expo, run the app with:
> ```json
> "ios": "expo run:ios",
> "android": "expo run:android"
> ```
> These commands build and run the native iOS and Android projects. <br/>
> And make sure the Android `minSdkVersion` is set to 28.
> 

## Community

- X account: <a href="https://twitter.com/zkmopro"><img src="https://img.shields.io/twitter/follow/zkmopro?style=flat-square&logo=x&label=zkmopro"></a>
- Telegram group: <a href="https://t.me/zkmopro"><img src="https://img.shields.io/badge/telegram-@zkmopro-blue.svg?style=flat-square&logo=telegram"></a>

## Acknowledgements

This work was initially sponsored by a joint grant from [PSE](https://pse.dev/) and [0xPARC](https://0xparc.org/). It is currently incubated by PSE.
